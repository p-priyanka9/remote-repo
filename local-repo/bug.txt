fixing bug in this code
